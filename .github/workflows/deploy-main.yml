# This is a basic workflow to help you get started with Actions

name: ApprovalAPI Deploy

# Controls when the action will run. 
on:
  # Triggers the workflow on push or pull request events but only for the master branch
  workflow_run:
    workflows: ["BaseSkripsi API"]
    types: [completed]
jobs:
  on-success:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
       - name: trigger single Job
         uses: appleboy/jenkins-action@master
         with:
          url: "http://srv.dvnlabs.xyz:8888"
          user: ${{ secrets.USER_JENKINS }}
          token: ${{ secrets.TOKEN_JENKINS }}
          job: "DeployAPI"
  on-failure:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    steps:
      - name: Deploy Failed
        run: echo 'DEPLOY FAILED'
